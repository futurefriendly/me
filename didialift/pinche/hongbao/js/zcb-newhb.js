!function(t,e){var i=t.documentElement,n="orientationchange"in window?"orientationchange":"resize",a=function(){var t=i.clientWidth;t&&(i.style.fontSize=20*(t/375)+"px")};t.addEventListener&&(e.addEventListener(n,a,!1),t.addEventListener("DOMContentLoaded",a,!1))}(document,window);var friend_list=$("#friend_list"),write_input=$("#write_input"),sub_btn=$("#sub_btn"),fixjump_div=$("#fixjump_div"),tipsTxt=$("#tipsTxt"),close_jump=$("#close_jump"),getPhone=$("#getPhone"),myScroll,hastouch="ontouchstart"in window?!0:!1,tapend=hastouch?"touchend":"click",newHb={writezdata:function(){"object"==typeof theme_config&&0!=theme_config.extra_btn.btn_extra_name.length?($("#second_btn").attr("href",theme_config.extra_btn.btn_extra_link),$("#second_btn").text(theme_config.extra_btn.btn_extra_name)):$("#second_btn").parent().hide()},addtips:function(t){for(var e=[],i=null,n=0;n<t.length;n++)e.push("<p>"+t[n]+"</p>");return i=e.join("")},replyfn:function(){sub_btn.bind(tapend,function(){var t=write_input.val()||write_input.attr("placeholder"),e={},i=$(this);$(this).hasClass("hover")||$(this).attr("disabled").length||($(this).addClass("hover"),0==loadVar.need_phone?(e={reply_words:t},newHb.goAjax(e,i)):($(this).removeClass("hover"),fixjump_div.show(),$("#state_input").show(),$("#get_djq").bind("click",function(){i=$(this),/^1[3|4|5|8|7][0-9]\d{8}$/.test(getPhone.val())&&(t=write_input.val()||write_input.attr("placeholder"),e={reply_words:t,phone:getPhone.val()},_send("newhbpagenewuser-pv_index_ck",{phone:getPhone.val()},!0),$(this).hasClass("hover")||($(this).addClass("hover"),newHb.goAjax(e,i)))})))}),$(".close_btn").bind("click",function(){$(this).parent().hide(),fixjump_div.hide()}),$(".close_jump").bind("click",function(){$(this).parents(".fix_son").hide(),fixjump_div.hide()}),getPhone.bind("input",function(){/^1[3|4|5|8|7][0-9]\d{8}$/.test(getPhone.val())&&11==getPhone.val().length?$("#get_djq").removeClass("btn-gray").addClass("btn-orange"):$("#get_djq").removeClass("btn-orange").addClass("btn-gray")}),$(".yyw_div a").bind("touchend",function(){location.href=$(this).attr("href")})},getCode:function(t){var e=null;switch(t.status){case 0:var i=$("#state_0");if(e=t.list_info.length,fixjump_div.show(),"shunfengche"==t.bonus_type)i.find(".top_p").text("送你1张滴滴顺风车代金券"),i.find(".have_q").text(t.amount+"元乘车券").show(),$("#for_server").text("顺风车");else if("zhuanche"==t.bonus_type)i.find(".top_p").text("送你1张滴滴专车代金券"),i.find(".itNum").text(t.int_num),i.find(".ftNum").text(t.float_num),i.find(".top_zcq span").text(t.amount),i.find(".have_zcq").show(),$("#for_server").text("专车");else if("daijia"==t.bonus_type){i.find(".top_p").text("送你1张滴滴代驾代金券"),$("#for_server").text("代驾"),i.find("#djMoney").text(t.amount);var n=t.instructions;n.length>10&&(n=n.substring(0,10)+"..."),i.find("#djTxt").text(n),i.find(".have_daijia").show()}$("#my_phone").text(t.phone),$("#state_0").show(),$("#change_phone").attr("href",t.modify_button_url),sub_btn.attr("disabled","disabled"),write_input.attr("disabled","disabled"),$(".haveInput").css("background","#d8d8d8"),friend_list.html("");for(var a=0;e>a;a++)friend_list.append(newHb.creatList(t.list_info[a]));newHb.isScroll();break;case 1:fixjump_div.hide(),sub_btn.attr("disabled","disabled"),write_input.attr("disabled","disabled"),$(".haveInput").css("background","#d8d8d8"),tipsTxt.text("你已经领过代金券了").show(),newHb.isScroll();break;case 2:fixjump_div.show(),$("#state_2").find(".top_p").text("手慢了，代金券已经被抢完"),$("#state_2").find(".no_djq img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_10.png"),$("#state_2").show();break;case 3:fixjump_div.show(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),$("#state_err").find(".top_p").text("对不起，代金券还未开始");break;case 4:fixjump_div.show(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),$("#state_err").find(".top_p").text("对不起，代金券已过期");break;case 5:fixjump_div.show(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),$("#state_err").find(".top_p").text("对不起，手气不好，没有领到")}},goAjax:function(t,e){var i=dd.dialog.loading("请求中，请稍后...");$.ajax({type:"GET",url:loadVar.button_url,data:t,dataType:"json",timeout:"5000",success:function(t){console.log(t),i.hide(),e.removeClass("hover"),"block"==$("#state_input").css("display")&&$("#state_input").hide(),"block"==$(".noper_get").css("display")&&$(".noper_get").hide(),0==t.errno?newHb.getCode(t):(fixjump_div.show(),$("#state_err").find(".top_p").text(t.errmsg),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show())},error:function(){fixjump_div.show(),i.hide(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),e.removeClass("hover")}})},creatList:function(t){var e=[],i=null;return e.push('<li><span class="left_span"><img src="'+t.headimgurl+'" alt=""></span>'),e.push('<div class="right_div"><p class="top_txt"><span>'+t.floor+"</span>"+t.nickname+"<span>"+t.create_time+"</span></p>"),e.push('<div class="have_arrow"><i></i>'+t.reply_words+'<span class="add_djq">+'+t.amount+"元</span></div></div></li>"),i=e.join("")},setHeight:function(){var t=$(window).height();setTimeout(function(){var e=$(".xhb_div_04").height();$("#wrapper").height(t-e)},0)},domUnload:function(){location.href.indexOf("?")>0&&history.replaceState({},document.title,location.search+"&a="+Date.now())},isScroll:function(){myScroll=new IScroll("#wrapper",{useTransition:!0}),setTimeout(function(){myScroll.refresh()},100),document.addEventListener("touchmove",function(t){t.preventDefault()},!1)},cireImg:function(){$("#cz_info img").css("height",$("#cz_info img").width()),$("#ck_info img").css("height",$("#ck_info img").width())},isAndroid:function(){/Android/.test(navigator.appVersion)&&$(".xhb_div_04").css("position","fixed")},creatDiv:function(){function t(t){function e(){if(o.width/o.height>innerWidth/innerHeight)var t=Math.min(o.width,innerWidth),e=t*o.height/o.width;else var e=Math.min(o.height,innerHeight),t=e*o.width/o.height;a.css({width:t,height:e,left:(innerWidth-t)/2,top:(innerHeight-e)/2})}var i=t.attr("src"),n=$('<div class="show_imgPa"><img src="'+i+'" id="creatImg"></div>'),a=n.find("#creatImg");n.appendTo("body");var o=t.attr("class","").offset();t.attr("class","have_tx"),e(),setTimeout(function(){a.css({overflow:"hidden"})},60),n.bind("touchend",function(){n.remove(),n.unbind(),$(window).off("resize",e)}),$(window).on("resize",e)}$(".have_tx").bind(tapend,function(){""!=$(this).attr("have_url")?location.href=$(this).attr("have_url"):t($(this))})},init:function(){newHb.writezdata(),newHb.replyfn(),newHb.domUnload(),newHb.isScroll(),newHb.isAndroid(),newHb.creatDiv(),newHb.setHeight()}};newHb.init();