!function(t,e){var i=t.documentElement,n="orientationchange"in window?"orientationchange":"resize",o=function(){var t=i.clientWidth;t&&(i.style.fontSize=20*(t/375)+"px")};t.addEventListener&&(e.addEventListener(n,o,!1),t.addEventListener("DOMContentLoaded",o,!1))}(document,window);var friend_list=$("#friend_list"),write_input=$("#write_input"),sub_btn=$("#sub_btn"),fixjump_div=$("#fixjump_div"),tipsTxt=$("#tipsTxt"),close_jump=$("#close_jump"),getPhone=$("#getPhone"),myScroll,newHb={writezdata:function(){"object"==typeof theme_config&&0!=theme_config.extra_btn.btn_extra_name.length?($("#second_btn").attr("href",theme_config.extra_btn.btn_extra_link),$("#second_btn").text(theme_config.extra_btn.btn_extra_name)):$("#second_btn").parent().hide()},addtips:function(t){for(var e=[],i=null,n=0;n<t.length;n++)e.push("<p>"+t[n]+"</p>");return i=e.join("")},replyfn:function(){sub_btn.bind("click",function(){var t=write_input.val()||write_input.attr("placeholder"),e={},i=$(this);$(this).hasClass("hover")||($(this).addClass("hover"),0==loadVar.need_phone?(e={reply_words:t},newHb.goAjax(e,i)):($(this).removeClass("hover"),fixjump_div.show(),$("#state_input").show(),$("#get_djq").bind("click",function(){i=$(this),/^1[3|4|5|8|7][0-9]\d{8}$/.test(getPhone.val())&&(t=write_input.val()||write_input.attr("placeholder"),e={reply_words:t,phone:getPhone.val()},console.log(e),$(this).hasClass("hover")||($(this).addClass("hover"),newHb.goAjax(e,i)))})))}),$(".close_btn").bind("click",function(){$(this).parent().hide(),fixjump_div.hide()}),$(".close_jump").bind("click",function(){$(this).parents(".fix_son").hide(),fixjump_div.hide()}),getPhone.bind("input",function(){/^1[3|4|5|8|7][0-9]\d{8}$/.test(getPhone.val())&&11==getPhone.val().length?$("#get_djq").removeClass("btn-gray").addClass("btn-orange"):$("#get_djq").removeClass("btn-orange").addClass("btn-gray")}),$(".yyw_div a").bind("touchend",function(){location.href=$(this).attr("href")})},getCode:function(t){var e=null;switch(t.status){case 0:e=t.list_info.length,fixjump_div.show(),$("#state_0 .have_q").text(t.amount+"元乘车券"),$("#my_phone").text(t.phone),$("#state_0").show(),$("#change_phone").attr("href",t.modify_button_url),sub_btn.attr("disabled","disabled"),write_input.attr("disabled","disabled"),friend_list.html("");for(var i=0;e>i;i++)friend_list.append(newHb.creatList(t.list_info[i]));newHb.isScroll();break;case 1:fixjump_div.hide(),sub_btn.attr("disabled","disabled"),write_input.attr("disabled","disabled"),tipsTxt.text("你已经领过代金券了").show(),newHb.isScroll();break;case 2:fixjump_div.show(),$("#state_2").find(".top_p").text("手慢了，代金券已经被抢完"),$("#state_2").find(".no_djq img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_10.png"),$("#state_2").show();break;case 3:fixjump_div.show(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),$("#state_err").find(".top_p").text("对不起，代金券还未开始");break;case 4:fixjump_div.show(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),$("#state_err").find(".top_p").text("对不起，代金券已过期");break;case 5:fixjump_div.show(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),$("#state_err").find(".top_p").text("对不起，手气不好，没有领到")}},goAjax:function(t,e){var i=dd.dialog.loading("请求中，请稍后...");$.ajax({type:"GET",url:loadVar.button_url,data:t,dataType:"json",timeout:"5000",success:function(t){console.log(t),i.hide(),e.removeClass("hover"),"block"==$("#state_input").css("display")&&$("#state_input").hide(),"block"==$(".noper_get").css("display")&&$(".noper_get").hide(),0==t.errno?newHb.getCode(t):(fixjump_div.show(),$("#state_err").find(".top_p").text(t.errmsg),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show())},error:function(){fixjump_div.show(),i.hide(),$("#state_err").find(".fwq_down img").attr("src","http://static.xiaojukeji.com/pinche/hongbao/images/nhb_img_11.png"),$("#state_err").show(),e.removeClass("hover")}})},creatList:function(t){var e=[],i=null;return e.push('<li><span class="left_span"><img src="'+t.headimgurl+'" alt=""></span>'),e.push('<div class="right_div"><p class="top_txt"><span>'+t.floor+"</span>"+t.nickname+"<span>"+t.create_time+"</span></p>"),e.push('<div class="have_arrow"><i></i>'+t.reply_words+'<span class="add_djq">+'+t.amount+"元</span></div></div></li>"),i=e.join("")},creatJump:function(t){},domUnload:function(){location.href.indexOf("?")>0&&history.replaceState({},document.title,location.search+"&a="+Date.now())},isScroll:function(){myScroll=new IScroll("#wrapper",{useTransition:!0}),setTimeout(function(){myScroll.refresh()},100),document.addEventListener("touchmove",function(t){t.preventDefault()},!1);var t=$(window).height(),e=$(".xhb_div_04").height();$("#wrapper").height(t-e)},cireImg:function(){$("#cz_info img").css("height",$("#cz_info img").width()),$("#ck_info img").css("height",$("#ck_info img").width())},isAndroid:function(){/Android/.test(navigator.appVersion)&&$(".xhb_div_04").css("position","fixed")},init:function(){newHb.writezdata(),newHb.replyfn(),newHb.domUnload(),newHb.isScroll(),newHb.cireImg(),newHb.isAndroid(),$(window).bind("resize",function(){newHb.cireImg()})}};newHb.init();