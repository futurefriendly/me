<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>顺风车新手礼包</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" type="text/css" href="/static/common/css/merged-common-ui.css">
    <link href="../static/css/didi-noviceCeremony.css" rel="stylesheet" >
    <link rel="sharelogo" href="../static/img/share-logo.jpg">
</head>

<body class="didi-bg-f0f0f0" style="position:relative">
     
     <div class="didi-banner">
         <img src="../static/img/banner.jpg">         
     </div>

     <div class="didi-article">
            <div style="height:2.2rem"></div>
            <div class="didi-ticket">
                <img src="../static/img/didi-ticket.png">
            </div>


            <div class="didi-form">
                   <form action="" id="myform">
                       <p><input type="tel" name="telphone" placeholder="输入手机号" id="telput" maxlength="11"></p>
                   </form>
            </div>

            <div class="didi-btn" style="margin-top:15px">
                <a href="javascript:void(0)" class="btn-orange" id="btnSubmit">领取乘车券</a>
                <p></p>
            </div> 


     </div>


    <script type="text/javascript" src="/static/common/js/zepto.js"></script>
    <script type="text/javascript" src="/static/common/js/merged-base-dialog.js"></script>
    <script type="text/javascript">
    
    // 校验手机号码
    function isTel(str){
        var reg = /^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/;
        if (!reg.test(str)){
            return false;
        }
        return true;
    }

    dd.ready(function() {
        var base = dd.base || {};
        var telinput = document.getElementById('telput'),
            btnSubmit = document.getElementById('btnSubmit');
            buttonurl = '<?php echo $button_url; ?>';

              telinput.addEventListener("focus",function(){
                 telinput.style.borderColor = "#ffbd66"
              });

              telinput.addEventListener("blur",function(){
                 telinput.style.borderColor = "#e5e5e5"
              });


        // 提交表单
        base.touch(btnSubmit, function() {

            if (telinput.value == "") {
                dd.dialog.alert("请填写手机号码~");
                return false;
            }else if(!isTel(telinput.value)){
                dd.dialog.alert("请填写正确的手机号码~");
                return false;
            }

            base.ajax({
                method: "GET",
                url: buttonurl + (
                        buttonurl.indexOf('?') >= 0 ? '&' : '?'
                    )
                    + 'phone=' + telinput.value,
                succFunc: function(data) {
                    
                    var j = base.txtToJson(data);  

                    if (j.errno == 0) {
                        if(window.DidiJSBridge){
                                 window.location.href= j.app_next_url
                        }else{
                                 window.location.href= j.not_app_next_url
                        }
                    }else{
                        dd.dialog.alert(j.errmsg);
                        return;
                    }
                },
                failFunc: function() {
                        dd.dialog.alert("网络不太稳定，提交失败，请稍后再试。");
                        return
                }
            });




        }, false);

        function concatUrl(url, param) {
            if(url.indexOf('?') >= 0) {
                return url + '&' + param;
            }
            else {
                return url + '?' + param;
            }
        }

    });
    </script>
    <script type="text/javascript" src="/static/common/js/app-wx-share.js"></script>
    <script type="text/javascript">

$(function(){

    document.body.style.height 
        = window.innerHeight + "px";
                
    var shareTitle = '<?php echo $share_title; ?>',
        shareDesc = '<?php echo $share_content; ?>',
        shareLink = '<?php echo $share_url; ?>',
        shareImgUrl = '<?php echo $share_pic; ?>';


    initWxShare({
        title: shareTitle,
        desc: shareDesc,
        link: shareLink, 
        imgUrl: shareImgUrl 
    });

});
    
    </script>
</body>
</html>
