define("page/login/main.js",function(o){var e=o("didibridge");!function(){var n=function(o,e){var n={};return o=o.replace(/\s+/g,""),o.split(e).forEach(function(o){var e=o.split("="),t=decodeURIComponent(e.shift());t=t&&t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),n[t]=decodeURIComponent(e.join("=")),n[t]=n[t]&&n[t].replace(/</g,"&lt;").replace(/>/g,"&gt;")}),n},t=function(o){var e=[];for(var n in o)o.hasOwnProperty(n)&&(e[e.length]=[n+"="+encodeURIComponent(o[n])]);return e.join("&")};console.log("start"+location.search+location.hash);var r=n(location.search.slice(1),"&"),l=n(location.hash.slice(1),"&"),c="http://wap.didialift.com/pinche/publicreg/program/change?psource=0&regfrom=9999&regsource=0",i=r.redirect||c;i+=-1===i.indexOf("?")?"?":"&",i+="token=";var a=l.loginsum||0,g=5,s=function(){return a>=g?(console.log("loginSumOverflow:"+g),void console.log("loginSum:"+a)):(a++,l.loginsum=a,location.replace("#"+t(l)),e.callNativeLogin(),void o("dd").dialog.confirm({text:"请确认完成登录才能继续！",confirm:{val:"知道了",handler:function(){f(s)}},cancel:{val:"取消登录",handler:function(){f(function(){e.closePage()})}}}))},f=function(o){if(r.token)return console.log("token from query :"+info.token),alert(i+r.token);console.log("getUserInfo before");e.getUserInfo(function(e){return e=JSON.parse(e),console.log(e),e.token?(console.log("getUserInfo before:"+e.token),alert(i+e.token)):void o(e)})},u=function(o){console.log(Date.now()),console.log(o),setTimeout(function(){f(u)},300)};f(s),u()}()});