<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=utf-8"/>
    <meta id="viewport" name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta content="telephone=no" name="format-detection"/>
    <title>滴滴打车</title>
    <style type="text/css">
    *{margin: 0;padding: 0}
    	html {
			font-size: 10px;
			width: 100%;
			height: 100%;
			background: #FFF;
		}
		body {
			color: #777;
			font-family: 微软雅黑;
			-webkit-appearance: none;
			-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
			overflow: hidden;
			width: 100%;
			height: 100%;
		}
		ul li {
			list-style: none
		}
		* {
			margin: 0;
		}
		img {
			border: none;
		}
		input {
			outline: none;
			-webkit-outline: none;
		}
		#logo{
			width: 100%;
			height: 40%;
			position: absolute;
			top: 30%;
			text-align: center;
		}
    .btnPa{
      text-align: center;
      position: absolute;
      top: 50%;
      width: 100%;
    }
    .redbtn{
        background: #ff8803;
      border-radius: 8px;
      color: #fff;
      padding: 0.55rem 0;
      width: 100%;
      text-align: center;
      display: inline-block;
      font-size: 1.8rem;
      text-decoration: none;
      width: 80%;
    }
    </style>
</head>
<body>
	<div id="logo">
		<img src="http://www.xiaojukeji.com/website/images/icon02.png?ver=916" width="108">
	</div>
	<p class="btnPa">
	 <a href="javascript:;" class="download-app redbtn" >下载客户端</a>
   </p>
<script type="text/javascript" src="http://static.xiaojukeji.com/pinche/js/zeptov2.js"></script>
<script type="text/javascript" src="http://static.xiaojukeji.com/pinche/beat-dist/static/common/js/didi-h5-monitor.js"></script>
<script type="text/javascript">
var _send = DidiMonitor.sendBeatles;
_send('openinwx-loadpage-20150916_sw',null,true);
(function() {
var Data = {
	os: null,
    downloadApp: {
       ios:{
          "packageName": "com.xiaojukeji.didi",
          "packageUrl": "diditaxi:passenger",
          "downloadUrl": "https://itunes.apple.com/cn/app/di-di-da-che-zhi-jian-shang/id554499054?ls=1&mt=8"
       },
       android:{
         "packageName": "com.sdu.didi.psnger",
         "packageUrl": "didipasnger://didi_apk_intalled_scheme",
         "downloadUrl": "http://dldir1.qq.com/diditaxi/apk/didi_psngr.apk"
       }
    },
        init: function() {
            Render.init();
            Event.init();
        }
}
var Render = {
	init: function() {
            Render.downloadApp();
        },
    //设置微信显示，隐藏，分享
        weixin: function(fn) {
            //微信相关
            var onBridgeReady = function() {
                if (!WeixinJSBridge) {
                    return; // 保证WeixinJSBridge存在
                } 
               
                if(fn){
                   fn();
                }else{
     
                define_wx_share(WeixinJSBridge);
                }
            };

            //微信控制
            if (typeof WeixinJSBridge === "undefined") {
                document.addEventListener('WeixinJSBridgeReady', onBridgeReady);
                return;
            } else {
                onBridgeReady();
            }
            // WeixinJSBridge.call('hideToolbar'); //隐藏底部工具栏
            // WeixinJSBridge.call('hideOptionMenu'); //隐藏右上角分享按钮

        },
	//初始化下载按钮对应的链接
    downloadApp: function() {
       var os='';
       if ((navigator.userAgent.match(/(Android)/i)) ) {
           os = 'android';
         } else if ( (navigator.userAgent.match(/(iPhone|iPod|ios|iPad)/i)) ) {
           os = 'ios';
         }
      Data.os = Data.downloadApp[os];
    }
}
var Event = {
	init: function() {
          Event.downloadApp();
      },
	//下载客户端
      downloadApp: function() {
          os=Data.os;
			var goto=function(type){
				if(type=="download"){
					url = os.downloadUrl;
					document.querySelector('.download-app').innerHTML = '下载客户端';
				}else{
					url = os.packageUrl;
          _send('openinwx-loadpage-20150916_autoopenapp_ck',null,true);
          setTimeout(function(){
            location.href=url;
            document.querySelector('.download-app').innerHTML = '立即使用';
          },300)
				}
				document.querySelector('.download-app').addEventListener('click',function(e){
          _send('openinwx-loadpage-20150916_downloadbtn_ck',null,true);
          setTimeout(function(){
            location.href = url;
          },300)
				},false);
			}
         
		
			 // console.log(os); 
         	if(navigator.userAgent.match(/(micromessenger)/i)) {
            	Render.weixin(function(){
					setTimeout(function() {
						WeixinJSBridge.invoke('getInstallState', os, function(e) {

							 var msg = e.err_msg;
							if(msg.indexOf("get_install_state:yes") > -1){
								goto("app");
							}else{
								goto("download");
							}
						});
					}, 200);
				});
            }else if(os){
				      goto("download");
            }else{
                document.querySelector('.download-app').style.opacity=0;
			}
             

      }
}
	function define_wx_share(WeixinJSBridge) {
          WeixinJSBridge.on('menu:share:appmessage', function() {
              WeixinJSBridge.invoke('sendAppMessage', {
                  "appid": "wx69b6673576ec5a65"
              },
              function(res) {});
          });

          
      }

	document.addEventListener("DOMContentLoaded", function(ev) {

          Data.init();
      },
      false);
})();
</script>
</body>

</html>
