<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" media="(device-height: 568px)" />
    <title>积分商城</title>

    <style type="text/css">
    *{
        margin: 0;
        padding: 0;
    }
    body{
        background: #fff;
    }
    img {
        width: 100%;
        display: block;
    }
    .contant {
        width: 100%;
        overflow: hidden;
        background: ;
    }
    .item {
        width: 100%;
    }
    .line {
        width: 100%;
    }
    .line img{
        float: left;
    }
    .share{
        width: 50%;
    }
    #divShare {
        top: 0;
        position: fixed;
        background-position: center;
        background-size: cover;
        z-index: 999;
        width: 100%;
        height: 100%;
        display: none;
        background-image: url('http://static.diditaxi.com.cn/webapp/images/mask-share.png');
    }
    #shop{
        position: fixed;
        bottom: 0;
    }
    </style>
</head>

<body>
    <div class="contant">
        <img src="../img-mall/shop_520_list/shop_520_list_01.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_02.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_25.jpg" id="s_left"/>
        <img src="../img-mall/shop_520_list/shop_520_list_05.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_06.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_07.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_08.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_09.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_10.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_11.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_12.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_13.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_14.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_15.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_16.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_17.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_18.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_19.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_20.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_21.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_22.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_23.jpg" />
        <img src="../img-mall/shop_520_list/shop_520_list_26.jpg" id="shop"/>
        <div style="height:57px"></div>
    </div>
    <div class="share" id="divShare"></div>
    <script type="text/javascript" src="http://static.diditaxi.com.cn/activity/lib/didi.jbase.js"></script>
    <script>
    addEventListener("DOMContentLoaded", function() {
        var s_left = document.getElementById("s_left"),
            shop = document.getElementById("shop");

        touch(shop,function(){
            location.href = 'http://imall.diditaxi.com.cn/imall/index?token=' + getQuerySting().token + '&lat=' + getQuerySting().lat + '&lng=' + getQuerySting().lng;
        });

        //微信分享
        document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
            touch(shop,function(){
                location.href = "http://pay.xiaojukeji.com/api/v2/weixinapi?page=middlepage";
            });

            //默认
            var share_config = {
                general_config:{
                    img_url: 'http://static.diditaxi.com.cn/activity/img-mall/shop_520_list/share.jpg',
                    sharetitle:"人生还有多少总以为，我决定今天就要跟你告白",
                    sharedesc:"5.20全民告白日，不等待，不错过，就今天去告白。",
                    link:"http://static.diditaxi.com.cn/site/pages/520_love/index.html?v="+Math.random()
                }
            };
            var obj = share_config.general_config;

            // 分享给朋友
            WeixinJSBridge.on('menu:share:appmessage', function(argv) {              
                WeixinJSBridge.invoke('sendAppMessage', {
                    "appid": "wx69b6673576ec5a65",
                    "img_url": obj.img_url,
                    "img_width": "",
                    "img_height": "",
                    "link": obj.link,
                    "title": obj.sharetitle,
                    "desc": obj.sharedesc               
                }, function(res) {
                    
                });
            });

            // 分享到朋友圈
            WeixinJSBridge.on('menu:share:timeline', function(argv) {     
                WeixinJSBridge.invoke('shareTimeline', {
                        "img_url": obj.img_url,
                        "img_width": "",
                        "img_height": "",
                        "link": obj.link,
                        "title": obj.sharetitle,
                        "desc": obj.sharedesc
                    }, function(res) {        
                });
            });

            var divShare = document.getElementById("divShare");

            s_left.addEventListener("touchstart", function(ev) {
                divShare.style.display = "block";
            }, false);

            divShare.addEventListener("touchstart", function(ev) {
                divShare.style.display = "none";
            }, false);
        });

        //app分享
        (function(window) {
            // 连接DidiJSBridge
            var connectDidiJSBridge = function(callback) {
                if (window.DidiJSBridge) {
                    callback(DidiJSBridge);
                } else {
                    document.addEventListener('DidiJSBridgeReady', function() {
                        callback(DidiJSBridge);
                    }, false);
                }
            };

            var shareData = {
                    share_url: 'http://static.diditaxi.com.cn/site/pages/520_love/index.html', // 分享出去的URL
                    share_icon_url: 'http://static.diditaxi.com.cn/activity/img-mall/shop_520_list/share.jpg', // 分享⼩图icon
                    share_img_url: 'http://static.diditaxi.com.cn/activity/img-mall/shop_520_list/share.jpg', // 分享⼤图
                    share_title: '人生还有多少总以为，我决定今天就要跟你告白。',
                    share_content: '5.20全民告白日，不等待，不错过，就今天去告白。',
                        share_from: 'native' // 分享来源，便于做统计
            };
            // 操作入口的配置信息
            var entranceCfg = {
                entrance: { // ⼊⼝本⾝的icon可定制，不限于微信的右上⾓三个点
                    icon: ''
                },
                buttons: [ {
                        type: 'share_weixin_timeline',
                        name: '微信朋友圈',
                        data: {
                            share_url: shareData.share_url, // 分享出去的URL
                            share_icon_url: shareData.share_icon_url, // 分享⼩图icon
                            share_img_url: shareData.share_icon_url, // 分享⼤图
                            share_title: shareData.share_title,
                            share_content: shareData.share_content,
                            share_from: shareData.share_from // 分享来源，便于做统计
                        },
                        callback: function() {}
                    },
                    {
                        type: 'share_weixin_appmsg',
                        name: '微信好友',
                        data: {
                            share_url: shareData.share_url, // 分享出去的URL
                            share_icon_url: shareData.share_icon_url, // 分享⼩图icon
                            share_img_url: shareData.share_icon_url, // 分享⼤图
                            share_title: shareData.share_title,
                            share_content: shareData.share_content,
                            share_from: shareData.share_from // 分享来源，便于做统计
                        },
                        callback: function() {}
                    }, 
                    {
                        type: "page_refresh",
                        name: "刷新"
                    }]
            };
            // 执行连接DidiJSBridge
            connectDidiJSBridge(function(bridge) {
                if (typeof bridge === 'undefined') {
                    return;
                }
               
                // use bridge object
                bridge.callHandler('init_entrance', JSON.stringify(entranceCfg)); // 初始入口

                s_left.addEventListener("touchend", function(e) {
                    if (typeof bridge === 'undefined') {
                        //alert('别坑我啊⼤哥，JSBridge对象⽊有加载成功啊.');
                        return;
                    }           
                   
                    bridge.callHandler("invoke_entrance");
                }, false);
   
            });

        })(window, undefined);

    }, false);
    </script>
</body>

</html>
