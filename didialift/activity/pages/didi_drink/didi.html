<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<title>滴滴饮料车</title>
	<link rel="stylesheet" href="http://static.diditaxi.com.cn/webapp/css/merged-common-ui.css">
</head>
	<style>
		html,
		body{
			margin: 0;
			padding: 0;
			background:#fff;
		}
		img {
			margin: 0;
			padding: 0;
			width: 100%;
			height: auto;
		}
		.group{
			width:100%;
			overflow:hidden;
		}
		.group img{
			display:block;
		}
		.group-a{
			width:80%;
			padding:0 10%;
			overflow:hidden;
			padding-bottom:3px;
			background:#f1f9fc;
		}
		.a-line{
			width:100%;
			display:block;
			overflow:hidden;
		}
		.mt10{
			margin-top:10px;
		}
		#divShare {
			top: 0;
			position: fixed;
			background-position: center;
			background-size: cover;
			z-index: 999;
			width: 100%;
			height: 100%;
			display: none;
			background-image: url('http://static.diditaxi.com.cn/webapp/images/mask-share.png');
		}
    </style>

<body>
	<div class="group">
        <img src="drink_img/drink_01.jpg">
		<img src="drink_img/drink_02.jpg">
		<img src="drink_img/drink_03.jpg">
		<img src="drink_img/drink_04.jpg">
		<img src="drink_img/drink_05.jpg">
	</div>

	<a class="a-line" href="http://static.diditaxi.com.cn/activity/pages/pizza.html"><img src="drink_img/drink_06.jpg"></a>
	<a class="a-line mt10" id="linkShare"><img src="drink_img/drink_07.jpg"></a>

	<div class="group">
		<img src="drink_img/drink_08.jpg">
    </div>

	<div class="share" id="divShare"></div>
</body>
</html>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=46392933" charset="UTF-8"></script>
<script type="text/javascript" src="http://static.diditaxi.com.cn/activity/lib/didi.jbase.js"></script>
<script>
	(function(){
		var dv_click = document.getElementById('linkShare');
        var divShare = document.getElementById('divShare');
        touch(dv_click, function(event) {
            var isWx = false;
            isWx = navigator.userAgent.indexOf("MicroMessenger")!=-1 ? true : false;
            if (isWx) {
                divShare.style.display = "block";
                return;
            }else{
                /*alert('只支持微信和APP内分享');*/
            }    
        }, false);
        divShare.addEventListener("touchstart", function(ev) {
            divShare.style.display = "none";
        }, false);
		
		//微信分享
        document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
            var share_config = {
                general_config:{
                    img_url: 'http://static.diditaxi.com.cn/activity/pages/didi_drink/share.jpg',
                    sharetitle:"滴滴饮料车，一键送你免费喝饮料",
                    sharedesc:"不免费的活动都是耍流氓，然而滴滴却能给你送上免费饮料",
                    link:"http://static.diditaxi.com.cn/activity/pages/didi_drink/didi.html?v="+Math.random()
                }
            };

            var obj = share_config.general_config;
            // 分享给朋友
            WeixinJSBridge.on('menu:share:appmessage', function(argv) {              
                WeixinJSBridge.invoke('sendAppMessage', {
                    "appid": "wx69b6673576ec5a65",
                    "img_url": obj.img_url,
                    "img_width": "",
                    "img_height": "",
                    "link": obj.link,
                    "title": obj.sharetitle,
                    "desc": obj.sharedesc               
                }, function(res) {
                    
                });
            });

            // 分享到朋友圈
            WeixinJSBridge.on('menu:share:timeline', function(argv) {     
                WeixinJSBridge.invoke('shareTimeline', {
                        "img_url": obj.img_url,
                        "img_width": "",
                        "img_height": "",
                        "link": obj.link,
                        "title": obj.sharetitle,
                        "desc": obj.sharedesc
                    }, function(res) {        
                });
            });
        });
		
		//app分享
        (function(window) {
            var linkShare = document.getElementById('linkShare');
            // 连接DidiJSBridge
            var connectDidiJSBridge = function(callback) {
                if (window.DidiJSBridge) {
                    callback(DidiJSBridge);
                } else {
                    document.addEventListener('DidiJSBridgeReady', function() {
                        //alert('这是DIDIJSBridge' + DidiJSBridge);
                        callback(DidiJSBridge);
                    }, false);
                }
            };

            var shareData = {
                share_url: "http://static.diditaxi.com.cn/activity/pages/didi_drink/didi.html", // 分享出去的URL
                share_icon_url: 'http://static.diditaxi.com.cn/activity/pages/didi_drink/share.jpg', // 分享⼩图icon
                share_img_url: 'http://static.diditaxi.com.cn/activity/pages/didi_drink/share.jpg', // 分享⼤图
                share_title: '滴滴饮料车，一键送你免费喝饮料',
                share_content: '不免费的活动都是耍流氓，然而滴滴却能给你送上免费饮料',
                share_from: 'native' // 分享来源，便于做统计
            };
            // 操作入口的配置信息
            var entranceCfg = {
                entrance: { // ⼊⼝本⾝的icon可定制，不限于微信的右上⾓三个点
                    icon: ''
                },
                buttons: [ {
                        type: 'share_weixin_timeline',
                        name: '微信朋友圈',
                        data: {
                            share_url: shareData.share_url, // 分享出去的URL
                            share_icon_url: shareData.share_icon_url, // 分享⼩图icon
                            share_img_url: shareData.share_icon_url, // 分享⼤图
                            share_title: shareData.share_title,
                            share_content: shareData.share_content,
                            share_from: shareData.share_from // 分享来源，便于做统计
                        },
                        callback: function() {}
                    }, {
                        type: 'share_weixin_appmsg',
                        name: '微信好友',
                        data: {
                            share_url: shareData.share_url, // 分享出去的URL
                            share_icon_url: shareData.share_icon_url, // 分享⼩图icon
                            share_img_url: shareData.share_icon_url, // 分享⼤图
                            share_title: shareData.share_title,
                            share_content: shareData.share_content,
                            share_from: shareData.share_from // 分享来源，便于做统计
                        },
                        callback: function() {}
                    }
                    //, {
                    //     type: 'web_redirect', // ⾃定义的按钮
                    //     name: '打⻋券使⽤规则',
                    //     icon: 'http://static.diditaxi.com.cn/webapp/images/driver.png',
                    //     redirect_url: 'http://www.baidu.com'
                    //}
                ]
            };
            // 执行连接DidiJSBridge
            connectDidiJSBridge(function(bridge) {
                if (typeof bridge === 'undefined') {
                    //alert('还没有这个DidiJSBridge对象，吧啦吧啦啦');
                    return;
                }
                // use bridge object
                bridge.callHandler('init_entrance', JSON.stringify(entranceCfg)); // 初始入口

                linkShare.addEventListener("touchend", function(e) {
                    if (typeof bridge === 'undefined') {
                        //alert('别坑我啊⼤哥，JSBridge对象⽊有加载成功啊.');
                        return;
                    }            
                    // console.log(it.method);
                    bridge.callHandler("invoke_entrance");
                }, false);
            });

        })(window, undefined);
		
	})()
</script>
