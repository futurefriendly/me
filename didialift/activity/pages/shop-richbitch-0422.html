<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" media="(device-height: 568px)" />
    <title>积分商城</title>

    <style type="text/css">
    *{
        margin: 0;
        padding: 0;
    }
    body{
        background: #cc1430;
    }
    img {
        width: 100%;
        display: block;
    }
    .contant {
        width: 100%;
        overflow: hidden;
        background: ;
    }
    .item {
        width: 100%;
    }
    .line {
        width: 100%;
    }
    </style>
</head>

<body>
    <div class="contant">
        <div class="item line" itemid="">
            <img src="../img-mall/0422-imall/01.jpg" />
        </div>
        <div class="item line" itemid="" id="btn">
            <img src="../img-mall/0422-imall/btn.jpg" />
        </div>
        <div class="item line" itemid="">
            <img src="../img-mall/0422-imall/01_1.jpg" />
        </div>
        <div class="item" itemid="6895">
            <img src="../img-mall/0422-imall/02.jpg" />
        </div>
        <div class="item" itemid="6877">
            <img src="../img-mall/0422-imall/03.jpg" />
        </div>
        <div class="item" itemid="6949">
            <img src="../img-mall/0422-imall/04.jpg" />
        </div>
        <div class="item line" itemid="">
            <img src="../img-mall/0422-imall/05.jpg" />
        </div>
        <div class="item" itemid="6703">
            <img src="../img-mall/0422-imall/06.jpg" />
        </div>
        <div class="item" itemid="6951">
            <img src="../img-mall/0422-imall/07.jpg" />
        </div>
        <div class="item" itemid="6953">
            <img src="../img-mall/0422-imall/08.jpg" />
        </div>
        <div class="item" itemid="6955">
            <img src="../img-mall/0422-imall/09.jpg" />
        </div>
        <div class="item line" itemid="">
            <img src="../img-mall/0422-imall/10.jpg" />
        </div>
        <div class="item" itemid="6957">
            <img src="../img-mall/0422-imall/11.jpg" />
        </div>
        <div class="item" itemid="6959">
            <img src="../img-mall/0422-imall/12.jpg" />
        </div>
        <div class="item" itemid="6961">
            <img src="../img-mall/0422-imall/13.jpg" />
        </div>
        <div class="item" itemid="6963">
            <img src="../img-mall/0422-imall/14.jpg" />
        </div>
        <div class="item" itemid="6965">
            <img src="../img-mall/0422-imall/15.jpg" />
        </div>
        <div class="item" itemid="6967">
            <img src="../img-mall/0422-imall/16.jpg" />
        </div>
        <div class="item line" itemid="">
            <img src="../img-mall/0422-imall/17.jpg" />
        </div>
        <div class="item" itemid="6707">
            <img src="../img-mall/0422-imall/18.jpg" />
        </div>
        <div class="item" itemid="6693">
            <img src="../img-mall/0422-imall/19.jpg" />
        </div>
        <div class="item" itemid="6699">
            <img src="../img-mall/0422-imall/20.jpg" />
        </div>
        <div class="item line" itemid="">
            <img src="../img-mall/0422-imall/21.jpg" />
        </div>
    </div>
    <script type="text/javascript" src="http://static.diditaxi.com.cn/activity/lib/didi.jbase.js"></script>
    <script type='text/javascript' src="http://static.diditaxi.com.cn/webapp/ddbridge.js"></script>
    <script>
    addEventListener("load", function() {
        //设置按钮的相对高度
        var _document = document,
            screenHeight = window.screen.height,
            dv_main = _document.querySelector(".contant");

        //get url params
        function getQueryString(name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return r[2];
            return "";
        }

        function returnUrl(id) {
            var _url = 'http://diditaxi.com.cn/imall/detail?id=' + id + '&token=' + getQueryString("token") + '&lat=' + getQueryString("lat") + '&lng=' + getQueryString("lng");
            return _url;
        }

        touch(dv_main, function(event) {
            if (event.target.className == "item" || event.target.parentNode.className == "item") {
                var _target = event.target.nodeName == "DIV" ? event.target : event.target.parentNode;
                var _itemid = _target.getAttribute("itemid");
                if (_itemid) {
                    if (getQueryString("loc")) {
                        location.href = returnUrl(_itemid);
                        return;
                    };
                    var isWx = false;
                    isWx = navigator.userAgent.indexOf("MicroMessenger")!=-1 ? true : false;
                    if (isWx) {
                        location.href = "http://pay.xiaojukeji.com/api/v2/weixinapi?page=middlepage&productid="+_itemid;
                        return;
                    }else{
                        location.href = "http://pay.xiaojukeji.com/api/v2/weixinapi?page=middlepage";
                        return;
                    }    
                }
            }
        }, false);
        var dv_click=document.getElementById('btn');
        touch(dv_click, function(event) {
            if (getQueryString("loc")) {
                location.href='http://imall.diditaxi.com.cn/imall/index?token=' + getQueryString("token") + '&lat=' + getQueryString("lat") + '&lng=' + getQueryString("lng");
            }else{
                location.href="http://pay.xiaojukeji.com/api/v2/weixinapi?page=middlepage";
            }   
        }, false);
        //微信分享
        document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
            var share_config = {
                general_config:{
                    img_url: 'http://static.diditaxi.com.cn/activity/img-mall/0422-imall/share.jpg',
                    sharetitle:"滴滴积分商城，奢华商品第二季",
                    sharedesc:"品质生活，浪漫爱情，时尚配饰，宝贝乐园-尽在滴滴积分商城。",
                    link:"http://static.diditaxi.com.cn/activity/pages/shop-richbitch-0422.html?v="+Math.random()
                }
            };

            var obj = share_config.general_config;
            // 分享给朋友
            WeixinJSBridge.on('menu:share:appmessage', function(argv) {              
                WeixinJSBridge.invoke('sendAppMessage', {
                    "appid": "wx69b6673576ec5a65",
                    "img_url": obj.img_url,
                    "img_width": "",
                    "img_height": "",
                    "link": obj.link,
                    "title": obj.sharetitle,
                    "desc": obj.sharedesc               
                }, function(res) {
                    
                });
            });

            // 分享到朋友圈
            WeixinJSBridge.on('menu:share:timeline', function(argv) {     
                WeixinJSBridge.invoke('shareTimeline', {
                        "img_url": obj.img_url,
                        "img_width": "",
                        "img_height": "",
                        "link": obj.link,
                        "title": obj.sharetitle,
                        "desc": obj.sharedesc
                    }, function(res) {        
                });
            });
        });

    }, false);
    </script>
</body>

</html>
