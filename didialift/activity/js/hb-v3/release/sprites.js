var SpriteAnimator,Sprite,ImagePainter=function(a){this.image=new Image,this.image.src=a};ImagePainter.prototype={image:void 0,paint:function(a,b){void 0!==this.image&&(this.image.complete?b.drawImage(this.image,a.left,a.top,a.width,a.height):this.image.onload=function(){a.width=this.width,a.height=this.height,b.drawImage(this,a.left,a.top,a.width,a.height)})}},SpriteSheetPainter=function(a){this.cells=a},SpriteSheetPainter.prototype={cells:[],cellIndex:0,advance:function(){var a,b;return this.cellIndex==this.cells.length-1?(a=document.getElementById("torch"),b=document.getElementById("master"),null!=a&&(a.style.display="none",b.style.display="block",a.remove(0)),!1):(this.cellIndex++,void 0)},paint:function(a,b){var c=this.cells[this.cellIndex];b.drawImage(spritesheet,c.left,c.top,410,659,a.left,a.top,c.width,c.height)}},SpriteAnimator=function(a,b){this.painters=a,b&&(this.elapsedCallback=b)},SpriteAnimator.prototype={painters:[],duration:1e4,startTime:0,index:0,elapsedCallback:void 0,end:function(a,b){a.animating=!1,this.elapsedCallback?this.elapsedCallback(a):a.painter=b},start:function(a,b){var c=+new Date+b,d=b/this.painters.length,e=void 0,f=this,g=a.painter;this.index=0,a.animating=!0,a.painter=this.painters[this.index],e=setInterval(function(){+new Date<c?a.painter=f.painters[++f.index]:(f.end(a,g),clearInterval(e))},d)}},Sprite=function(a,b,c){return void 0!==a&&(this.name=a),void 0!==b&&(this.painter=b),void 0!==c&&(this.behaviors=c),this},Sprite.prototype={left:0,top:0,width:10,height:10,velocityX:0,velocityY:0,visible:!0,animating:!1,painter:void 0,behaviors:[],paint:function(a){void 0!==this.painter&&this.visible&&this.painter.paint(this,a)},update:function(a,b){for(var c=this.behaviors.length;c>0;--c)this.behaviors[c-1].execute(this,a,b)}};