document.addEventListener("DOMContentLoaded",function(){function t(t){0==t.errno?e(t):fooState("none","none","block")}function e(t){function e(t){v.cTitle=t.cTitle,v.cCount=t.cCount,v.cCode=t.cCode,v.cValidity=t.cValidity,v.title=t.title,v.comCount=t.comCount,v.comCode=t.comCode,v.validity=t.validity,v.link=t.link,v.imgUrl=t.imgUrl}for(var a=t.data,d=a.page_count,r=a.convertList,m=[],s={},g=0;g<r.length;g++){var v={},y=r[g].status,C=r[g].activity_type,f=r[g].isEnd,k=r[g].goods_type;if(0==y&&1==C){var E={cTitle:"",cCount:"content_count",cCode:"orange",cValidity:"hide",title:r[g].title,comCount:r[g].comCount,comCode:"参与抽奖，未中奖 ~~",validity:r[g].validity,link:r[g].link,imgUrl:r[g].imgUrl};e(E)}else if(1==y&&0==C&&0==f){var h="";h=1==k?"已发放，到“我的打车券”查看":"券码："+r[g].comCode;var E={cTitle:"",cCount:"content_count",cCode:"",cValidity:"orange",title:r[g].title,comCount:r[g].comCount,comCode:h,validity:r[g].validity+" 后过期",link:r[g].link,imgUrl:r[g].imgUrl};e(E)}else if(1==y&&0==C&&1==f){var h="";h=1==k?"已发放，到“我的打车券”查看":"券码："+r[g].comCode;var E={cTitle:"",cCount:"content_count",cCode:"",cValidity:"gray",title:r[g].title,comCount:r[g].comCount,comCode:h,validity:r[g].validity+" 后过期（已过期）",link:r[g].link,imgUrl:r[g].imgUrl};e(E)}else if(1==y&&1==C&&0==f){var h="";h=1==k?"已发放，到“我的打车券”查看":"券码："+r[g].comCode;var E={cTitle:"win",cCount:"content_count",cCode:"",cValidity:"orange",title:r[g].title,comCount:r[g].comCount,comCode:h,validity:r[g].validity+" 后过期",link:r[g].link,imgUrl:r[g].imgUrl};e(E)}else if(1==y&&1==C&&1==f){var h="";h=1==k?"已发放，到“我的打车券”查看":"券码："+r[g].comCode;var E={cTitle:"win",cCount:"content_count",cCode:"",cValidity:"gray",title:r[g].title,comCount:r[g].comCount,comCode:h,validity:r[g].validity+" 后过期（已过期）",link:r[g].link,imgUrl:r[g].imgUrl};e(E)}else{var E={cTitle:"hide",cCount:"hide",cCode:"hide",cValidity:"hide",title:r[g].title,comCount:r[g].comCount,comCode:r[g].comCode,validity:r[g].validity,link:r[g].link,imgUrl:r[g].imgUrl};e(E)}m.push(v)}s.recData=m,0==d?(i.style.display="none",o.style.display="none",l.style.display="block"):u==d?(o.style.display="none",c.style.display="block"):fooState("none","inline-block","none");var _=n.createElement("section");_.innerHTML=template("list_item",s),i.insertBefore(_,null);var p=i.children[i.children.length-1].getElementsByTagName("img");load_img(p)}var n=document,i=n.getElementById("record"),o=n.getElementById("footer"),l=n.getElementById("noRecord"),c=(n.getElementById("foo_more"),n.getElementById("foo_loading"),n.getElementById("foo_noth"),n.getElementById("foo_no")),a=n.getElementById("token").value,d=n.getElementById("lat").value,r=n.getElementById("lng").value,m=n.getElementById("recordData").value,s=txtToJson(m),g=n.getElementById("product_id").value,u=1,v=new dd.dialog.Fn('<div class="loading-car"><div class="bg"></div><div class="loading-car-icon"></div></div>');v.hide(),shareFn(),window.addEventListener("popstate",function(){v.hide()},!1),t(s),s.data.convertList.length>0&&g==s.data.convertList[0].product_id&&(addClass(i.getElementsByClassName("list")[0],"new"),addClass(i.getElementsByClassName("list")[0].getElementsByTagName("div")[0],"new_border")),i.addEventListener("click",function(t){var e=function(t){var e=new RegExp("\\blist\\b");return e.test(t.className)?t:arguments.callee(t.parentNode)},n=e(t.target);return n.getAttribute("href")?(v.show(),location.href=n.getAttribute("href"),void 0):void 0},!1),o.addEventListener("click",function(){u++,fooState("inline-block","none","none"),ajax({method:"GET",url:"/imall/change_log/index?token="+a+"&page="+u+"&lng="+r+"&lat="+d,succFunc:function(e){var n=txtToJson(e);t(n)},failFunc:function(){fooState("none","none","block")}})},!1)},!1);