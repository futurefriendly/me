var devCfg=[{pattern:"/static/webapp/src/",replacement:"/static/webapp/"},{pattern:"http://static.udache.com/gulfstream/webapp/js/biz.min.js",replacement:"http://static.udache.com/gulfstream/webapp/js/biz.min.js"},{pattern:"http://api.udache.com/gulfstream/api/v1/webapp/pIndex",replacement:"http://api.udache.com/gulfstream/api/v1/webapp/pIndex"},{pattern:"http://api.udache.com/gulfstream/api/v1/webapp/pGetFlag",replacement:"http://api.udache.com/gulfstream/api/v1/webapp/pGetFlag"},{pattern:"http://api.udache.com/gulfstream/api/v1/webapp/",replacement:"http://api.udache.com/gulfstream/api/v1/webapp/"}],releaseCfg=[{pattern:"http://static.xiaojukeji.com/activity/",replacement:"http://static.xiaojukeji.com/activity/"}],file={src:"./*.js",dest:"../"},files=[{src:["./css/dd.common.css","./css/dd.ui.css"],name:"merged-common-ui.css",dest:"./css/"},{src:["./lib/dd.base.js","./lib/dd.dialog.js","./lib/color.js","./js/p-hold.js"],name:"merged-base-dialog-color-hold.js",dest:"./js/"},{src:["./lib/dd.base.js","./lib/sha1.js"],name:"merged-base-sha1.js",dest:"./js/"},{src:["./lib/dd.base.js","./lib/dd.dialog.js"],name:"merged-base-dialog.js",dest:"./js/"}],gulp=require("gulp"),frep=require("gulp-frep"),concat=require("gulp-concat"),uglify=require("gulp-uglify"),minifyCSS=require("gulp-minify-css"),mapPattern=function(e){for(var a=null,t=e.length-1;t>=0;t--)a=e[t],a.pattern=new RegExp(a.pattern,"ig")},getHandler=function(e){var a=e.split(".").pop(),t="js"===a?uglify:minifyCSS;return t},handler=function(e){mapPattern(e),gulp.src(file.src).pipe(frep(e)).pipe(getHandler(file.src)()).pipe(gulp.dest(file.dest));for(var a=0,t=files.length;t>a;a++){var p=files[a];gulp.src(p.src).pipe(concat(p.name)).pipe(gulp.dest(p.dest)),gulp.src(p.dest+p.name).pipe(frep(e)).pipe(getHandler(p.name)()).pipe(gulp.dest("."+p.dest))}};gulp.task("default",function(){handler(devCfg)}),gulp.task("release",function(){handler(releaseCfg)});