let hasTouch="ontouchstart"in window,tapend=hasTouch?"touchend":"click",scrollPos=0,windowH=$(window).height(),windowW=$(window).width(),documentH=0,pct=0,sectionOffset=[];function rafThrottle(e){let t=!1;return function(...o){t||(requestAnimationFrame(()=>{e.apply(this,o),t=!1}),t=!0)}}function secHeight(){var e=$("section").length;for(let o=0;o<e;o++)sectionOffset[o]=Math.floor($("section").eq(o).offset().top)}function onScroll(){scrollPos=Math.floor($(document).scrollTop()),$("body").toggleClass("scroll",290<scrollPos),scrollPos>sectionOffset[2]?$("body").addClass("f_dark_bg"):$("body").removeClass("f_dark_bg"),scrollPos>sectionOffset[4]&&$("body").removeClass("f_dark_bg"),scrollPos>sectionOffset[7]&&$("body").addClass("f_dark_bg"),scrollPos>sectionOffset[8]&&$("body").removeClass("f_dark_bg"),documentH=$(document).height(),pct=100-scrollPos/documentH*100+"%",$("#loadbar").css("transform",`translateX(-${pct})`)}function onResize(){secHeight(),windowH=$(window).height(),windowW=$(window).width()}function textsize(o,e){$("html").removeClass("f_font14 f_font16 f_font18").addClass("f_font"+o),document.getElementById("option_txtsize").childNodes.forEach(o=>{o.style&&(o.style.textDecoration="none")}),e.style.textDecoration="underline",secHeight()}function initCarousel(o,e){$(o).owlCarousel(Object.assign({autoplay:!1,smartSpeed:250,lazyLoad:!0,margin:20},e))}$(function(){secHeight(),$("nav").show(),$("nav a").on(tapend,secHeight),$(".f_play").on(tapend,function(){$(this).attr("target",1239<windowW?"h5stage":"_blank")}),$(".f_display").on(tapend,function(){$("#scene .layer").remove(),$("#showexp").css("opacity","1")[0].play()}),$(".f_expand").on(tapend,function(){$(this).parents(".f_sm").hide().siblings(".hid").show()}),initCarousel(".f_owl-carousel_map",{loop:!1,responsive:{0:{items:1},480:{items:1}}}),initCarousel(".f_owl-carousel_designsystem",{loop:!0,responsive:{0:{items:1},800:{items:2}}}),initCarousel(".f_owl-carousel_pku",{loop:!1,responsive:{0:{items:1},480:{items:1}}}),initCarousel(".f_owl-carousel_ufo",{loop:!0,responsive:{0:{items:2},600:{items:3}}}),initCarousel(".f_owl-carousel_wb",{autoplay:!0,autoplayTimeout:3e3,autoplayHoverPause:!0,loop:!0,responsive:{0:{items:1},800:{items:2}}}),initCarousel(".f_owl-carousel_dd",{smartSpeed:100,loop:!0,responsive:{0:{items:2},800:{items:4},1240:{items:5}}}),$("#h5stage").attr("src","https://www.futurefriendly.cn/ds/page/invitation2016.html")}),$(window).on("scroll",rafThrottle(onScroll)),$(window).on("resize",rafThrottle(onResize)),$(window).on("load",()=>{onScroll(),onResize()});let scroll=new SmoothScroll('a[href*="#"]',{speed:1e3});